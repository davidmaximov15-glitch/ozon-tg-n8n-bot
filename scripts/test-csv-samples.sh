#!/bin/bash

# Test CSV Samples Generator
# Creates sample FBO and FBS CSV files for testing

set -e

SAMPLES_DIR="test-samples"
mkdir -p "$SAMPLES_DIR"

echo "📝 Generating test CSV samples..."

# FBO Sample
cat > "$SAMPLES_DIR/fbo-sample.csv" << 'EOF'
Номер заказа,Статус заказа,Дата создания,Дата отгрузки,Дата доставки,Способ доставки,Артикул,Название товара,Количество,Цена за единицу,Скидка,Комиссия,Цена продажи,Сумма продажи,Регион,Комментарий,Кол-во для расчета
123456,Доставлен,2025-09-18 10:00:00,2025-09-19 08:00:00,2025-09-20 14:00:00,Курьер,ABC-001,Товар 1,2,1500,100,150,1190,2380,Москва,,2
123457,Отменён,2025-09-18 11:00:00,,,Курьер,ABC-001,Товар 1,1,1500,100,150,1190,1190,Москва,,1
123458,Ожидает отгрузки,2025-09-18 12:00:00,,,Курьер,ABC-002,Товар 2,3,1200,100,110,990,2970,Санкт-Петербург,,3
123459,Доставляется,2025-09-18 13:30:00,2025-09-19 09:00:00,,Курьер,ABC-001,Товар 1,1,1500,100,150,1190,1190,Казань,,1
123460,Возврат,2025-09-18 14:15:00,2025-09-19 10:00:00,2025-09-20 15:30:00,Постамат,ABC-002,Товар 2,2,1200,100,110,990,1980,Екатеринбург,,2
123461,Доставлен,2025-09-19 09:00:00,2025-09-20 08:00:00,2025-09-21 16:00:00,Курьер,ABC-003,Товар 3,1,2000,200,180,1590,1590,Москва,,1
123462,Ожидает сборки,2025-09-19 10:30:00,,,ПВЗ,ABC-001,Товар 1,4,1500,100,150,1190,4760,Новосибирск,,4
EOF

echo "✅ FBO sample created: $SAMPLES_DIR/fbo-sample.csv"

# FBS Sample
cat > "$SAMPLES_DIR/fbs-sample.csv" << 'EOF'
№ заказа,Артикул продавца,Кол-во,Цена,Дата создания,Статус,Регион доставки,Комментарий
987654,XYZ-777,1,990,2025-09-18 08:10:00,Доставляется,Москва,
987655,XYZ-777,2,990,2025-09-18 09:05:00,Возврат,Санкт-Петербург,
987656,XYZ-888,1,1590,2025-09-18 10:00:00,Создан,Казань,
987657,XYZ-777,3,990,2025-09-18 11:20:00,Доставлен,Нижний Новгород,
987658,XYZ-888,1,1590,2025-09-18 12:45:00,Отменён,Самара,
987659,XYZ-999,2,2500,2025-09-19 08:00:00,Ожидает отгрузки,Москва,
987660,XYZ-777,1,990,2025-09-19 09:15:00,Доставлен,Воронеж,
EOF

echo "✅ FBS sample created: $SAMPLES_DIR/fbs-sample.csv"

echo ""
echo "📊 Sample files ready for testing:"
echo "   - $SAMPLES_DIR/fbo-sample.csv (FBO format, 7 orders)"
echo "   - $SAMPLES_DIR/fbs-sample.csv (FBS format, 7 orders)"
echo ""
echo "💡 Use these files to test CSV upload in Telegram bot"
